#!/bin/bash

#
# Run tests. Use unbuffer to get a colored output
#

set -ex

oca_wait_for_postgres

unbuffer coverage run \
    $(which odoo || which openerp-server) \
    -d $PGDATABASE \
    -i $(addons --addons-dir "${ADDONS_DIR}" --include "${INCLUDE}" --exclude "${EXCLUDE}" list) \
    --test-enable \
    --stop-after-init

# TODO do we need to check for errors in test output?
